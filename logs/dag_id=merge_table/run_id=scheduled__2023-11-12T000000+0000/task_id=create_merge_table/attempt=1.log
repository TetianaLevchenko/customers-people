[2023-11-13T09:28:42.061+0000] {taskinstance.py:1087} INFO - Dependencies all met for <TaskInstance: merge_table.create_merge_table scheduled__2023-11-12T00:00:00+00:00 [queued]>
[2023-11-13T09:28:42.083+0000] {taskinstance.py:1087} INFO - Dependencies all met for <TaskInstance: merge_table.create_merge_table scheduled__2023-11-12T00:00:00+00:00 [queued]>
[2023-11-13T09:28:42.086+0000] {taskinstance.py:1283} INFO - 
--------------------------------------------------------------------------------
[2023-11-13T09:28:42.087+0000] {taskinstance.py:1284} INFO - Starting attempt 1 of 1
[2023-11-13T09:28:42.087+0000] {taskinstance.py:1285} INFO - 
--------------------------------------------------------------------------------
[2023-11-13T09:28:42.115+0000] {taskinstance.py:1304} INFO - Executing <Task(PostgresOperator): create_merge_table> on 2023-11-12 00:00:00+00:00
[2023-11-13T09:28:42.126+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'merge_table', 'create_merge_table', 'scheduled__2023-11-12T00:00:00+00:00', '--job-id', '603', '--raw', '--subdir', 'DAGS_FOLDER/merge.py', '--cfg-path', '/tmp/tmpar4fnmpu']
[2023-11-13T09:28:42.129+0000] {standard_task_runner.py:83} INFO - Job 603: Subtask create_merge_table
[2023-11-13T09:28:42.129+0000] {standard_task_runner.py:55} INFO - Started process 461 to run task
[2023-11-13T09:28:42.230+0000] {task_command.py:389} INFO - Running <TaskInstance: merge_table.create_merge_table scheduled__2023-11-12T00:00:00+00:00 [running]> on host 06d7566f07d2
[2023-11-13T09:28:42.616+0000] {taskinstance.py:1513} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Tetiana
AIRFLOW_CTX_DAG_ID=merge_table
AIRFLOW_CTX_TASK_ID=create_merge_table
AIRFLOW_CTX_EXECUTION_DATE=2023-11-12T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-11-12T00:00:00+00:00
[2023-11-13T09:28:42.618+0000] {sql.py:253} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS merged_table AS
        SELECT
        people.user_id AS _user_id,
        people.first_name AS _first_name,
        people.last_name AS _last_name,
        people.sex AS _sex,
        people.email AS _email,
        people.phone AS _phone,
        people.date_of_birth AS _date_of_birth,
        people.job_title AS _job_title
        FROM people
        INNER JOIN customers ON people.user_id = customers.customer_id;
        
        
[2023-11-13T09:28:42.633+0000] {base.py:73} INFO - Using connection ID 'postgres' for task execution.
[2023-11-13T09:28:43.001+0000] {base.py:73} INFO - Using connection ID 'postgres' for task execution.
[2023-11-13T09:28:43.005+0000] {sql.py:364} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS merged_table AS
        SELECT
        people.user_id AS _user_id,
        people.first_name AS _first_name,
        people.last_name AS _last_name,
        people.sex AS _sex,
        people.email AS _email,
        people.phone AS _phone,
        people.date_of_birth AS _date_of_birth,
        people.job_title AS _job_title
        FROM people
        INNER JOIN customers ON people.user_id = customers.customer_id;
        
        , parameters: None
[2023-11-13T09:28:43.020+0000] {taskinstance.py:1327} INFO - Marking task as SUCCESS. dag_id=merge_table, task_id=create_merge_table, execution_date=20231112T000000, start_date=20231113T092842, end_date=20231113T092843
[2023-11-13T09:28:43.073+0000] {local_task_job.py:159} INFO - Task exited with return code 0
[2023-11-13T09:28:43.105+0000] {taskinstance.py:2582} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2023-11-13T09:31:03.103+0000] {taskinstance.py:1087} INFO - Dependencies all met for <TaskInstance: merge_table.create_merge_table scheduled__2023-11-12T00:00:00+00:00 [queued]>
[2023-11-13T09:31:03.120+0000] {taskinstance.py:1087} INFO - Dependencies all met for <TaskInstance: merge_table.create_merge_table scheduled__2023-11-12T00:00:00+00:00 [queued]>
[2023-11-13T09:31:03.121+0000] {taskinstance.py:1283} INFO - 
--------------------------------------------------------------------------------
[2023-11-13T09:31:03.122+0000] {taskinstance.py:1284} INFO - Starting attempt 1 of 1
[2023-11-13T09:31:03.124+0000] {taskinstance.py:1285} INFO - 
--------------------------------------------------------------------------------
[2023-11-13T09:31:03.147+0000] {taskinstance.py:1304} INFO - Executing <Task(PostgresOperator): create_merge_table> on 2023-11-12 00:00:00+00:00
[2023-11-13T09:31:03.154+0000] {standard_task_runner.py:55} INFO - Started process 605 to run task
[2023-11-13T09:31:03.158+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'merge_table', 'create_merge_table', 'scheduled__2023-11-12T00:00:00+00:00', '--job-id', '607', '--raw', '--subdir', 'DAGS_FOLDER/merge.py', '--cfg-path', '/tmp/tmp1dvz4mku']
[2023-11-13T09:31:03.164+0000] {standard_task_runner.py:83} INFO - Job 607: Subtask create_merge_table
[2023-11-13T09:31:03.281+0000] {task_command.py:389} INFO - Running <TaskInstance: merge_table.create_merge_table scheduled__2023-11-12T00:00:00+00:00 [running]> on host 06d7566f07d2
[2023-11-13T09:31:03.613+0000] {taskinstance.py:1513} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=merge_table
AIRFLOW_CTX_TASK_ID=create_merge_table
AIRFLOW_CTX_EXECUTION_DATE=2023-11-12T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-11-12T00:00:00+00:00
[2023-11-13T09:31:03.614+0000] {sql.py:253} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS merged_table AS
            SELECT
            people.user_id AS _user_id,
            people.first_name AS _first_name,
            people.last_name AS _last_name,
            people.sex AS _sex,
            people.email AS _email,
            people.phone AS _phone,
            people.date_of_birth AS _date_of_birth,
            people.job_title AS _job_title
            FROM people
            INNER JOIN customers ON people.user_id = customers.customer_id;
        
        
[2023-11-13T09:31:03.630+0000] {base.py:73} INFO - Using connection ID 'postgres' for task execution.
[2023-11-13T09:31:03.939+0000] {base.py:73} INFO - Using connection ID 'postgres' for task execution.
[2023-11-13T09:31:03.944+0000] {sql.py:364} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS merged_table AS
            SELECT
            people.user_id AS _user_id,
            people.first_name AS _first_name,
            people.last_name AS _last_name,
            people.sex AS _sex,
            people.email AS _email,
            people.phone AS _phone,
            people.date_of_birth AS _date_of_birth,
            people.job_title AS _job_title
            FROM people
            INNER JOIN customers ON people.user_id = customers.customer_id;
        
        , parameters: None
[2023-11-13T09:31:03.961+0000] {taskinstance.py:1327} INFO - Marking task as SUCCESS. dag_id=merge_table, task_id=create_merge_table, execution_date=20231112T000000, start_date=20231113T093103, end_date=20231113T093103
[2023-11-13T09:31:04.019+0000] {local_task_job.py:159} INFO - Task exited with return code 0
[2023-11-13T09:31:04.053+0000] {taskinstance.py:2582} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2023-11-13T10:20:26.305+0000] {taskinstance.py:1087} INFO - Dependencies all met for <TaskInstance: merge_table.create_merge_table scheduled__2023-11-12T00:00:00+00:00 [queued]>
[2023-11-13T10:20:26.324+0000] {taskinstance.py:1087} INFO - Dependencies all met for <TaskInstance: merge_table.create_merge_table scheduled__2023-11-12T00:00:00+00:00 [queued]>
[2023-11-13T10:20:26.329+0000] {taskinstance.py:1283} INFO - 
--------------------------------------------------------------------------------
[2023-11-13T10:20:26.330+0000] {taskinstance.py:1284} INFO - Starting attempt 1 of 1
[2023-11-13T10:20:26.331+0000] {taskinstance.py:1285} INFO - 
--------------------------------------------------------------------------------
[2023-11-13T10:20:26.361+0000] {taskinstance.py:1304} INFO - Executing <Task(PostgresOperator): create_merge_table> on 2023-11-12 00:00:00+00:00
[2023-11-13T10:20:26.396+0000] {standard_task_runner.py:55} INFO - Started process 3452 to run task
[2023-11-13T10:20:26.408+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'merge_table', 'create_merge_table', 'scheduled__2023-11-12T00:00:00+00:00', '--job-id', '612', '--raw', '--subdir', 'DAGS_FOLDER/merge.py', '--cfg-path', '/tmp/tmpmbs8hzb4']
[2023-11-13T10:20:26.411+0000] {standard_task_runner.py:83} INFO - Job 612: Subtask create_merge_table
[2023-11-13T10:20:26.540+0000] {task_command.py:389} INFO - Running <TaskInstance: merge_table.create_merge_table scheduled__2023-11-12T00:00:00+00:00 [running]> on host 06d7566f07d2
[2023-11-13T10:20:26.961+0000] {taskinstance.py:1513} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=merge_table
AIRFLOW_CTX_TASK_ID=create_merge_table
AIRFLOW_CTX_EXECUTION_DATE=2023-11-12T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-11-12T00:00:00+00:00
[2023-11-13T10:20:26.962+0000] {sql.py:253} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS merged_table AS
            SELECT
            people.user_id AS user_id,
            people.first_name AS first_name,
            people.last_name AS last_name,
            people.sex AS sex,
            people.email AS email,
            people.phone AS phone,
            people.date_of_birth AS date_of_birth,
            people.job_title AS job_title
            FROM people
            INNER JOIN customers ON people.user_id = customers.customer_id;
        
        
[2023-11-13T10:20:27.062+0000] {base.py:73} INFO - Using connection ID 'postgres' for task execution.
[2023-11-13T10:20:27.791+0000] {base.py:73} INFO - Using connection ID 'postgres' for task execution.
[2023-11-13T10:20:27.800+0000] {sql.py:364} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS merged_table AS
            SELECT
            people.user_id AS user_id,
            people.first_name AS first_name,
            people.last_name AS last_name,
            people.sex AS sex,
            people.email AS email,
            people.phone AS phone,
            people.date_of_birth AS date_of_birth,
            people.job_title AS job_title
            FROM people
            INNER JOIN customers ON people.user_id = customers.customer_id;
        
        , parameters: None
[2023-11-13T10:20:27.805+0000] {taskinstance.py:1772} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 261, in execute
    return_last=self.return_last,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 338, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 369, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UndefinedTable: relation "people" does not exist
LINE 12:             FROM people
                          ^

[2023-11-13T10:20:27.844+0000] {taskinstance.py:1327} INFO - Marking task as FAILED. dag_id=merge_table, task_id=create_merge_table, execution_date=20231112T000000, start_date=20231113T102026, end_date=20231113T102027
[2023-11-13T10:20:27.874+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 612 for task create_merge_table (relation "people" does not exist
LINE 12:             FROM people
                          ^
; 3452)
[2023-11-13T10:20:27.903+0000] {local_task_job.py:159} INFO - Task exited with return code 1
[2023-11-13T10:20:27.941+0000] {taskinstance.py:2582} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-11-13T10:20:58.279+0000] {taskinstance.py:1087} INFO - Dependencies all met for <TaskInstance: merge_table.create_merge_table scheduled__2023-11-12T00:00:00+00:00 [queued]>
[2023-11-13T10:20:58.365+0000] {taskinstance.py:1087} INFO - Dependencies all met for <TaskInstance: merge_table.create_merge_table scheduled__2023-11-12T00:00:00+00:00 [queued]>
[2023-11-13T10:20:58.374+0000] {taskinstance.py:1283} INFO - 
--------------------------------------------------------------------------------
[2023-11-13T10:20:58.375+0000] {taskinstance.py:1284} INFO - Starting attempt 1 of 1
[2023-11-13T10:20:58.376+0000] {taskinstance.py:1285} INFO - 
--------------------------------------------------------------------------------
[2023-11-13T10:20:58.487+0000] {taskinstance.py:1304} INFO - Executing <Task(PostgresOperator): create_merge_table> on 2023-11-12 00:00:00+00:00
[2023-11-13T10:20:58.511+0000] {standard_task_runner.py:55} INFO - Started process 3485 to run task
[2023-11-13T10:20:58.520+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'merge_table', 'create_merge_table', 'scheduled__2023-11-12T00:00:00+00:00', '--job-id', '614', '--raw', '--subdir', 'DAGS_FOLDER/merge.py', '--cfg-path', '/tmp/tmpmkn1ul95']
[2023-11-13T10:20:58.523+0000] {standard_task_runner.py:83} INFO - Job 614: Subtask create_merge_table
[2023-11-13T10:20:58.812+0000] {task_command.py:389} INFO - Running <TaskInstance: merge_table.create_merge_table scheduled__2023-11-12T00:00:00+00:00 [running]> on host 06d7566f07d2
[2023-11-13T10:21:00.443+0000] {taskinstance.py:1513} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=merge_table
AIRFLOW_CTX_TASK_ID=create_merge_table
AIRFLOW_CTX_EXECUTION_DATE=2023-11-12T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-11-12T00:00:00+00:00
[2023-11-13T10:21:00.446+0000] {sql.py:253} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS merged_table AS
            SELECT
            people.user_id AS user_id,
            people.first_name AS first_name,
            people.last_name AS last_name,
            people.sex AS sex,
            people.email AS email,
            people.phone AS phone,
            people.date_of_birth AS date_of_birth,
            people.job_title AS job_title
            FROM people
            INNER JOIN customers ON people.user_id = customers.customer_id;
        
        
[2023-11-13T10:21:00.489+0000] {base.py:73} INFO - Using connection ID 'postgres' for task execution.
[2023-11-13T10:21:01.171+0000] {base.py:73} INFO - Using connection ID 'postgres' for task execution.
[2023-11-13T10:21:01.202+0000] {sql.py:364} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS merged_table AS
            SELECT
            people.user_id AS user_id,
            people.first_name AS first_name,
            people.last_name AS last_name,
            people.sex AS sex,
            people.email AS email,
            people.phone AS phone,
            people.date_of_birth AS date_of_birth,
            people.job_title AS job_title
            FROM people
            INNER JOIN customers ON people.user_id = customers.customer_id;
        
        , parameters: None
[2023-11-13T10:21:01.231+0000] {sql.py:373} INFO - Rows affected: 0
[2023-11-13T10:21:01.288+0000] {taskinstance.py:1327} INFO - Marking task as SUCCESS. dag_id=merge_table, task_id=create_merge_table, execution_date=20231112T000000, start_date=20231113T102058, end_date=20231113T102101
[2023-11-13T10:21:01.507+0000] {local_task_job.py:159} INFO - Task exited with return code 0
[2023-11-13T10:21:01.578+0000] {taskinstance.py:2582} INFO - 1 downstream tasks scheduled from follow-on schedule check
